<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Style Audit Test Page</title>
    
    <!-- CDN Version for Testing -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        .audit-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            background: white;
            border: 2px solid #333;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-width: 300px;
        }
        
        .audit-controls button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 8px 12px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .audit-controls button:hover {
            background: #2563eb;
        }
        
        .audit-results {
            margin-top: 10px;
            padding: 10px;
            background: #f3f4f6;
            border-radius: 4px;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-success { background: #10b981; }
        .status-warning { background: #f59e0b; }
        .status-error { background: #ef4444; }
    </style>
</head>
<body class="bg-[#F7F7FF] text-[#000000]">
    <!-- Audit Controls -->
    <div class="audit-controls">
        <h3 style="margin: 0 0 10px 0; font-size: 14px; font-weight: bold;">Style Audit Tools</h3>
        
        <button onclick="runQuickAudit()">Quick Audit</button>
        <button onclick="runFullAudit()">Full Audit</button>
        <button onclick="runResponsiveAudit()">Responsive Audit</button>
        <button onclick="validatePostCSS()">Validate PostCSS</button>
        <button onclick="exportResults()">Export Results</button>
        <button onclick="toggleCDN()">Toggle CDN</button>
        
        <div class="audit-results" id="auditResults">
            <div><span class="status-indicator status-warning"></span>Ready to audit</div>
        </div>
    </div>

    <!-- Main Content (Copy of your actual app structure) -->
    <header class="px-6 py-4 border-b border-[#BDD5EA]">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold tracking-tight text-[#10219F] flex items-baseline">
                boardom<span class="inline-block w-2 h-2 bg-[#000000] ml-1 rounded-full"></span>
            </h1>
        </div>
    </header>

    <section class="py-20 px-6">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-5xl md:text-6xl font-black mb-6 leading-tight text-[#000000]">
                Free Yourself from Prompting <span class="text-[#10219F]">boardom</span>
            </h2>
            
            <p class="text-lg md:text-xl text-[#000000] mb-12 max-w-3xl mx-auto leading-relaxed opacity-80">
                Direct your AI effectively. This kanban tool helps you prioritize what's important, letting AI focus on a feature at a time with generative prompting.
            </p>

            <div class="bg-[#10219F] text-[#F7F7FF] rounded-2xl p-8 max-w-lg mx-auto">
                <h3 class="text-2xl font-bold mb-2 text-[#F7F7FF]">Ready to Structure Your AI Workflow?</h3>
                <p class="text-[#BDD5EA] mb-6">
                    Join the waitlist and be first to experience boardom's intelligent prompting pipeline.
                </p>
                
                <div class="w-full max-w-sm mx-auto">
                    <form class="space-y-3">
                        <input
                            type="email"
                            placeholder="Enter your email address"
                            class="w-full bg-[#F7F7FF] border border-[#BDD5EA] text-[#000000] rounded-lg p-3 text-sm focus:ring-2 focus:ring-[#FE5F55] focus:border-[#FE5F55] transition-all placeholder-gray-500"
                        />
                        <button 
                            type="submit" 
                            class="w-full py-3 text-sm px-4 rounded-lg font-semibold transition-all duration-300 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-white bg-[#FE5F55] text-white hover:bg-red-600 focus:ring-[#FE5F55]"
                        >
                            Join Waitlist
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <section class="py-20 px-6 bg-[#BDD5EA] bg-opacity-30">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-4 text-[#000000]">
                Why boardom Changes Everything
            </h2>
            
            <div class="grid md:grid-cols-3 gap-8">
                <div class="bg-[#F7F7FF] border border-[#BDD5EA] rounded-xl p-8 text-center hover:shadow-lg transition-shadow">
                    <div class="w-16 h-16 bg-[#10219F] rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-8 h-8 text-[#F7F7FF]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-[#000000]">Smart Task Generation</h3>
                    <p class="text-[#000000] opacity-80">
                        Transform vague ideas into structured, actionable prompts with AI that understands development workflows.
                    </p>
                </div>

                <div class="bg-[#F7F7FF] border border-[#BDD5EA] rounded-xl p-8 text-center hover:shadow-lg transition-shadow">
                    <div class="w-16 h-16 bg-[#FE5F55] rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-8 h-8 text-[#F7F7FF]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-[#000000]">Guided Prompting Pipeline</h3>
                    <p class="text-[#000000] opacity-80">
                        Break free from endless prompting circles with contextual, structured AI guidance tailored to your workflow stage.
                    </p>
                </div>

                <div class="bg-[#F7F7FF] border border-[#BDD5EA] rounded-xl p-8 text-center hover:shadow-lg transition-shadow">
                    <div class="w-16 h-16 bg-[#000000] rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-8 h-8 text-[#F7F7FF]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-[#000000]">Intelligent Workflow</h3>
                    <p class="text-[#000000] opacity-80">
                        Visual workflow management that structures your AI development process and keeps projects moving forward.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Load audit utilities -->
    <script src="./utils/styleAuditor.js"></script>
    <script src="./utils/auditRunner.js"></script>
    <script src="./utils/postcssValidator.js"></script>

    <script>
        // Global instances
        let auditor = new StyleAuditor();
        let runner = new AuditRunner();
        let validator = new PostCSSValidator();
        let lastAuditResults = null;
        let cdnEnabled = true;

        function updateStatus(message, type = 'info') {
            const resultsDiv = document.getElementById('auditResults');
            const statusClass = type === 'success' ? 'status-success' : 
                              type === 'error' ? 'status-error' : 'status-warning';
            
            const timestamp = new Date().toLocaleTimeString();
            resultsDiv.innerHTML = `<div><span class="status-indicator ${statusClass}"></span>${timestamp}: ${message}</div>` + resultsDiv.innerHTML;
        }

        async function runQuickAudit() {
            updateStatus('Running quick audit...', 'info');
            try {
                const result = runner.quickAudit();
                updateStatus(`Quick audit complete: ${result.styles.size} elements captured`, 'success');
                lastAuditResults = { audits: { postcss: result } };
            } catch (error) {
                updateStatus(`Quick audit failed: ${error.message}`, 'error');
            }
        }

        async function runFullAudit() {
            updateStatus('Running full audit...', 'info');
            try {
                const results = await runner.runCompleteAudit();
                lastAuditResults = results;
                
                if (results.comparisons && results.comparisons.cdnVsPostcss) {
                    const comp = results.comparisons.cdnVsPostcss;
                    const accuracy = ((comp.summary.identicalElements / comp.summary.totalElements) * 100).toFixed(1);
                    updateStatus(`Full audit complete: ${accuracy}% style accuracy`, 'success');
                } else {
                    updateStatus('Full audit complete (no comparison available)', 'success');
                }
            } catch (error) {
                updateStatus(`Full audit failed: ${error.message}`, 'error');
            }
        }

        async function runResponsiveAudit() {
            updateStatus('Running responsive audit...', 'info');
            try {
                const results = await runner.runResponsiveAudit();
                updateStatus(`Responsive audit complete for ${Object.keys(results).length} viewports`, 'success');
                lastAuditResults = results;
            } catch (error) {
                updateStatus(`Responsive audit failed: ${error.message}`, 'error');
            }
        }

        async function validatePostCSS() {
            updateStatus('Validating PostCSS configuration...', 'info');
            try {
                if (lastAuditResults) {
                    validator.extractTailwindClasses(lastAuditResults);
                }
                
                const validation = await validator.validatePostCSSConfig();
                const issueCount = validation.issues.length;
                
                if (issueCount === 0) {
                    updateStatus('PostCSS validation passed', 'success');
                } else {
                    updateStatus(`PostCSS validation found ${issueCount} issues`, 'warning');
                }
            } catch (error) {
                updateStatus(`PostCSS validation failed: ${error.message}`, 'error');
            }
        }

        function exportResults() {
            if (!lastAuditResults) {
                updateStatus('No audit results to export', 'warning');
                return;
            }

            try {
                const exportData = runner.exportResults(lastAuditResults, 'json');
                const blob = new Blob([exportData.content], { type: exportData.mimeType });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = exportData.filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                updateStatus(`Results exported as ${exportData.filename}`, 'success');
            } catch (error) {
                updateStatus(`Export failed: ${error.message}`, 'error');
            }
        }

        function toggleCDN() {
            const cdnScript = document.querySelector('script[src*="tailwindcss.com"]');
            
            if (cdnEnabled && cdnScript) {
                cdnScript.remove();
                cdnEnabled = false;
                updateStatus('CDN disabled - styles should break', 'warning');
            } else if (!cdnEnabled) {
                const script = document.createElement('script');
                script.src = 'https://cdn.tailwindcss.com';
                document.head.appendChild(script);
                cdnEnabled = true;
                updateStatus('CDN enabled - styles should restore', 'success');
            }
        }

        // Initialize
        updateStatus('Style audit tools ready', 'success');
        
        // Auto-run quick audit on load
        setTimeout(runQuickAudit, 1000);
    </script>
</body>
</html>